{"name":"GPrege","tagline":"Gaussian process software in R and Matlab for detecting quiet genes. From Alfredo Kalaitzis's thesis work.","body":"\r\nGPREGE: Gaussian Process Ranking and Estimation of Gene Expression time-series\r\n======\r\n\r\nGaussian process software in R and Matlab for detecting quiet genes. From Alfredo Kalaitzis's thesis work.\r\n\r\nThe GPREGE software implements our methodology of Gaussian process regression models for the analysis of microarray time series, described in [3]. The package can be used to filter quiet genes and quantify differential expression in time-series expression ratios or for ranking candidate targets of a trascription factor. This page describes examples of how to use the GPREGE software. A detailed discussion of the ranking approach and dataset used can be found in the paper. \r\n\r\nBelow we detail how to run the MATLAB software. Information on the R software is provided in <a href=\"http://www.bioconductor.org/packages/devel/bioc/html/gprege.html\">this Bioconductor</a> package.\r\n\r\nIntroductory example analysis - TP63 microarray data\r\n---\r\n\r\nIn the following examples, we will be using experimental data from [2], available on the GEO database under accession number GSE10562. The ranking list of direct targets is available at <a href=\"http://genome.cshlp.org/content/suppl/2008/05/05/gr.073601.107.DC1/DellaGatta_SupTable1.xls\">genome.cshlp.org/content/suppl/2008/05/05/gr.073601.107.DC1/DellaGatta_SupTable1.xls</a> We load the experimental data,\r\n\r\n```matlab\r\nload DellaGattaData.mat \r\ntTrue = [0:20:240]'; % Times of sampling. \r\n```\r\n\r\nLoad BATS rankings (Angelini, 2008) Case 1: Delta error prior, Case 2: Inverse Gamma error prior, Case 3: Double Exponential error prior\r\n\r\n```matlab\r\nBATSranking = zeros(length(DGatta_labels_byTSNItop100), 3);\r\nBATSgenenumbers = zeros(length(DGatta_labels_byTSNItop100), 1);\r\nfor f = 1:3\r\n  importBATSrankingFile( ['DGdat_p63_case' num2str(f) '_GL.txt'],{'BATSrankdata','BATSgenenumbersStr'});\r\n  % Extract the gene numbers in the ranked list.\r\n  for i = 1:length(BATSrankdata)\r\n    BATSgenenumbers(i) = str2double(BATSgenenumbersStr{i+1,2}(2:end));\r\n  end\r\n  [~, ix] = sort(BATSgenenumbers);\r\n  BATSranking(:,f) = BATSrankdata(ix, 2); % Sort rankings by gene numbers.\r\nend\r\n```\r\n\r\nThe smaller a BATS-rank metric is, the better the rank of the gene reporter. Invert those rank metrics to compare on a common ground with gprege.\r\n\r\n```matlab\r\nBATSranking = 1./BATSranking;\r\n```\r\n\r\nWith a matrix we configure different hyperparameter initialisations. We use the following row structure: [inverse-lengthscale percent-signal-variance percent-noise-variance].\r\n\r\n```matlab\r\ngpregeOptions.inithypers = [1/1000 0 1; 1/20 0.999 1e-3; 1/80 2/3 1/3]; \r\n```\r\n\r\nSetup gprege options.\r\n\r\n```matlab\r\ngpregeOptions.exhaustPlotRes = 30; % Exhaustive plot resolution of the LML function.\r\ngpregeOptions.exhaustPlotMaxWidth = 100; % Exhaustive plot maximum lengthscale.\r\ngpregeOptions.exhaustPlotLevels = 10; % Exhaustive plot contour levels.\r\ngpregeOptions.labels = DGatta_labels_byTSNI; % Noisy ground truth labels (which genes are in the top 786 ranks of the TSNI ranking).\r\ngpregeOptions.iters = 100; % SCG optimisation: max iterations. \r\ngpregeOptions.display = false; % SCG optimisation: display messages.\r\n```\r\nInteractive mode\r\n---\r\n\r\nLet us now examine one by one, in an interactive fashion, a few time-courses of the these data. The following option makes GPREGE wait for a keystroke to proceed to the next profile.\r\n\r\n```matlab\r\ngpregeOptions.explore = true; % Explore individual profiles in an interactive fashion. \r\n```\r\n\r\nSet the index range so that the gene expression profiles correspond to the top ranks of direct targets, as suggested by TSNI [2].\r\n\r\n```matlab\r\ngpregeOptions.indexRange = find(DGatta_labels_byTSNItop100);\r\ngprege(exprs_tp63_RMA', tTrue, gpregeOptions); \r\n```\r\n\r\nGPREGE will generate a report and a few plots for each explored profile. The first line contains the index of the profile in exprs_tp63_RMA and its ground truth (according to TSNI).\r\nThe hyperparameters of the optimised log-marginal likelihood (LML) follow and then the initialisation (indicated by '<-') from which it came.\r\nThen a few statistics; the observed standard deviation of the time-series and the sum of the explained std.deviation (by the GP) and noise (Gaussian) std.deviation.\r\nFinally the function exhaustivePlot will reveal, through an exhaustive search in the hyperparemeter space, the approximate true maximum LML and corresponding hyperparameters. gpregeOptions.exhaustPlotMaxWidth defines the limit of the lengthscale search range.\r\n\r\n\r\n```\r\n============================================================\r\n\r\n Profile 249\t\t\t\t\tLabel: 1\r\n\r\n============================================================\r\n\r\n        Length-scale              Signal               Noise\r\n\r\n        8.473909e+01        2.290120e-01        3.297385e-02\r\n\r\n\r\n\r\n             Init.le                 LML                Best\r\n\r\n         1000.000000            2.944504                    \r\n\r\n           30.000000            9.873420                    \r\n\r\n           80.000000           16.694727                  <-\r\n\r\n\r\n\r\n       Total st.dev.\t  Estim. sig + noise\r\n\r\n        2.004927e-01\t        2.619858e-01\r\n\r\n\r\n\r\n      Log-ratio (max(LML(2:end))-LML[1])\r\n\r\n        1.375022e+01\r\n\r\n============= EXHAUSTIVE LML SEARCH ========================\r\n\r\n        Length-scale              Signal               Noise\r\n\r\n        7.410204e+01        1.676242e-01        3.286853e-02\r\n\r\n\r\n\r\n             Max LML  Estim. sig + noise\r\n\r\n           16.372396        2.004927e-01\r\n\r\n\r\n\r\nENTER to continue\r\n```\r\n  \r\n<p><center>\r\n<img src=\"html/gpPlot1.png\" width =\"45%\"> <img src=\"html/exhaustivePlot1.png\" width =\"45%\">\r\n<br>\r\nProﬁle #249.<br>\r\n<b>Left:</b> GP ﬁt with different initialisations on proﬁle #249.\r\n<b>Top-right:</b> Log-marginal likelihood (LML) contour.<br>\r\n<b>Bottom-right:</b> GP ﬁt with maximum LML hyperparameters from the exhaustive search.\r\n</center>\r\n\r\n\r\n```\r\n============================================================\r\n\r\n Profile 370\t\t\t\t\tLabel: 1\r\n\r\n============================================================\r\n\r\n        Length-scale              Signal               Noise\r\n\r\n        1.853874e+02        3.766069e-01        1.049200e-01\r\n\r\n\r\n\r\n             Init.le                 LML                Best\r\n\r\n         1000.000000            0.245622                    \r\n\r\n           30.000000            2.470319                    \r\n\r\n           80.000000            6.371275                  <-\r\n\r\n\r\n\r\n       Total st.dev.\t  Estim. sig + noise\r\n\r\n        2.467521e-01\t        4.815269e-01\r\n\r\n\r\n\r\n      Log-ratio (max(LML(2:end))-LML[1])\r\n\r\n        6.125653e+00\r\n\r\n============= EXHAUSTIVE LML SEARCH ========================\r\n\r\n        Length-scale              Signal               Noise\r\n\r\n        6.191837e+01        1.510173e-01        9.573479e-02\r\n\r\n\r\n\r\n             Max LML  Estim. sig + noise\r\n\r\n            5.075967        2.467521e-01\r\n\r\n\r\n\r\nENTER to continue\r\n```\r\n  \r\n<p><center>\r\n<img src=\"html/gpPlot1.png\" width =\"45%\"> <img src=\"html/exhaustivePlot1.png\" width =\"45%\">\r\n<br>\r\nProﬁle #370.<br>\r\n</center>\r\n\r\n\r\nRanking differential genes\r\n---\r\n\r\nNow we demonstrate bulk ranking of differential expression on the full dataset. Later we evaluate the results from the bulk ranking. Total computation time was approximately 30 minutes on a desktop running Ubuntu 10.04 with a dual-core CPU at 2.8 GHz and 3.2 GiB of memory.\r\n\r\n```matlab\r\ngpregeOptions.explore = false; % No interactive mode.\r\ngpregeOptions.indexRange = []; % Reset index range. All profiles will be ranked. \r\ngpregeOutput = gprege(exprs_tp63_RMA', tTrue, gpregeOptions); \r\n```\r\n\r\nComparing against BATS [1]\r\n---\r\nFinally, we demonstrate compareROC, a facility for comparing the performance of GPREGE on a dataset with some other method (see figure below). In this example, we reproduce the main result presented in [3].\r\nSpecifically, we apply standard Gaussian process regression and BATS [1] on experimental gene expression data, where only the top 100 ranks of TSNI were labelled as truly differentially expressed in the noisy ground truth. From the output of each model, a ranking of differential expression is produced and assessed with ROC curves to quantify how well in accordance to the noisy ground truth each method performs. For convenience, gprege was already run on the full DellaGatta dataset and the resulting rank metrics are stored in gpregeOutput.rankingScores (see demTp63Gp1.m).\r\n\r\nExperimental results demonstrated on the paper are slightly better than the ones presented here, because more initialisation points were used in optimising the likelihood wrt the kernel hypeparameters (gpregeOptions.inithypers) and the converged hyperparameters with the best log-marginal likelihood are always used to circumvent the non-convexity of the LML function.\r\n\r\nThe following compares GPREGE [3] to BATS [1] via ROC curves:\r\n\r\n```\r\ncompareROC(gpregeOutput.rankingScores, DGatta_labels_byTSNItop100, BATSranking);\r\n```\r\n \r\n<p><center>\r\n<img src=\"html/GPvsBATSonDGattaData.png\" width =\"45%\">\r\n<br>\r\nROC comparison on experimental data from [2].\r\nOne curve for the GP method and three for BATS, using different noise models\r\n(subscript 'G' for Gaussian, 'T' for Student's-t and 'DE' for double exponential\r\nmarginal distributions of error), followed by the area under the corresponding\r\ncurve (AUC).\r\n\r\n<br>\r\n</center>\r\n\r\nReferences\r\n--\r\n\r\n[1] C. Angelini, D. De Canditiis, M. Mutarelli, and M. Pensky. A Bayesian approach to estimation and testing in time-course microarray experiments. Stat Appl Genet Mol Biol, 6:24, 2007. \r\n\r\n[2] G. Della Gatta, M. Bansal, A. Ambesi-Impiombato, D. Antonini, C. Missero, and D. di Bernardo. Direct targets of the TRP63 transcription factor revealed by a combination of gene expression profiling and reverse engineering. Genome research, 18(6):939, 2008. \r\n\r\n[3] Alfredo A. Kalaitzis and Neil D. Lawrence. A simple approach to ranking differentially expressed gene expression time courses through Gaussian process regression. BMC Bioinformatics, 12(180), 2011. doi: 10.1186/1471-2105-12-180.\r\n","google":"UA-62971049-1","note":"Don't delete this file! It's used internally to help with page regeneration."}